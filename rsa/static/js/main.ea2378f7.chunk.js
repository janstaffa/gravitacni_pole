(this["webpackJsonprsa-encryption"]=this["webpackJsonprsa-encryption"]||[]).push([[0],{49:function(e,t,r){},50:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),a=r(13),s=r.n(a),i=r(10),u=r.n(i),l=r(14),o=r(5),j=r(4),d=r(11),b=r(7),O=function(e){return!!(e%2)},g=function(e){return new j.BigInteger(e)},h=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},x=[1,3,5,7,9],p=function(){var e=h(0,x.length-1);return x[e]},m=function(e){var t,r=e.split(""),n=j.BigInteger.ZERO,c=e.length-1,a=Object(b.a)(r);try{for(a.s();!(t=a.n()).done;){var s=t.value,i=parseInt(s,16);n=n.add(g(i.toString()).multiply(g("16").pow(c))),c--}}catch(u){a.e(u)}finally{a.f()}return n},f=function e(t){var r="",n=t;if(t.compareTo(g("16"))<0)return t.toString(16);do{var c=n.divideAndRemainder(g("16")),a=Object(o.a)(c,2);n=a[0],r=e(a[1])+r}while(n.compareTo(j.BigInteger.ZERO)>0);return r},v=function(e){var t,r=e.split(""),n="",c=Object(b.a)(r);try{for(c.s();!(t=c.n()).done;){n+=t.value.charCodeAt(0).toString(16)}}catch(a){c.e(a)}finally{c.f()}return m(n)},y=function(e){var t="";do{t="";for(var r=0;r<e;r++){t+=Math.floor(10*Math.random())}var n=parseInt(t[t.length-1]);O(n)||(t=t.slice(0,-1)+p())}while(!g(t).millerRabin(40)||0===g(t).compareTo(j.BigInteger.ZERO));return g(t)},N=function(e){for(var t="",r=0;r<e;r++)t+=String.fromCharCode(h(33,126));return t},R=r(1),w=function(){var e=Object(n.useRef)(null),t=Object(n.useRef)(null),r=Object(n.useRef)(null),c=Object(n.useRef)(null),a=Object(n.useRef)(null),s=Object(n.useRef)(null),i=Object(n.useRef)(null),b=Object(n.useRef)(null),O=Object(n.useRef)(null),h=Object(n.useState)(!1),x=Object(o.a)(h,2),p=x[0],w=x[1],S=Object(n.useState)(!1),I=Object(o.a)(S,2),k=I[0],E=I[1],B=Object(n.useState)(!0),T=Object(o.a)(B,2),C=T[0],M=T[1],Z=Object(n.useRef)(C);Z.current=C;var F=Object(n.useState)(!0),L=Object(o.a)(F,2),A=L[0],H=L[1],D=Object(n.useRef)(A);D.current=A;var P=Object(n.useState)(!1),z=Object(o.a)(P,2),J=z[0],Y=z[1],Q=Object(n.useRef)(J);Q.current=J;var V=Object(n.useState)(100),q=Object(o.a)(V,2),G=q[0],K=q[1],U=Object(n.useRef)(j.BigInteger.ZERO),W=Object(n.useRef)(j.BigInteger.ZERO),X=Object(n.useRef)(j.BigInteger.ZERO),$=Object(n.useRef)(j.BigInteger.ZERO),_=Object(n.useRef)(j.BigInteger.ZERO),ee=Object(n.useRef)(j.BigInteger.ZERO);Object(n.useEffect)((function(){var e,t;U.current=y(G),W.current=y(G),X.current=U.current.multiply(W.current),$.current=(e=U.current.compareTo(j.BigInteger.ONE)>0?U.current.subtract(j.BigInteger.ONE):j.BigInteger.ONE,t=W.current.compareTo(j.BigInteger.ONE)>0?W.current.subtract(j.BigInteger.ONE):j.BigInteger.ONE,e.multiply(t).divide(e.gcd(t)).abs()),_.current=new j.BigInteger("2").pow(16).add(j.BigInteger.ONE),ee.current=_.current.modInverse($.current)}),[G]),Object(n.useEffect)((function(){e.current&&(e.current.innerHTML=Q.current?ee.current.toString():ee.current.toString(16)),r.current&&t.current&&(r.current.innerHTML=Q.current?X.current.toString():X.current.toString(16),t.current.innerHTML=Q.current?_.current.toString():_.current.toString(16))}));var te=function(){var e=Object(l.a)(u.a.mark((function e(){var t,r,n,l,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.current&&a.current&&s.current&&i.current){e.next=3;break}return alert("Something went wrong, please try again later."),e.abrupt("return");case 3:if((t=c.current.value)&&0!==t.length&&a.current.value&&0!==a.current.value.length&&s.current.value&&0!==s.current.value.length){e.next=6;break}return e.abrupt("return");case 6:if(w(!0),r=m(a.current.value),n=m(s.current.value),!((l=v(Z.current?(u=t,(new Date).getTime().toString()+N(5)+" "+u+" "+u.length.toString()+N(5)):t)).compareTo(r)>=0)){e.next=14;break}return alert("This message is too long to encrypt."),w(!1),e.abrupt("return");case 14:o=l.modPow(n,r),setTimeout((function(){i.current.innerHTML=f(o),w(!1)}),1e3);case 16:case"end":return e.stop()}var u}),e)})));return function(){return e.apply(this,arguments)}}();return Object(R.jsxs)("div",{className:"App",children:[Object(R.jsx)("img",{src:"/images/background.png",alt:"Background",className:"background"}),Object(R.jsxs)("div",{className:"main",children:[Object(R.jsx)("h1",{children:"RSA encryption"}),Object(R.jsx)("hr",{}),Object(R.jsxs)("div",{className:"text-center text",children:[Object(R.jsxs)("div",{className:"text padding-y",children:[Object(R.jsx)("label",{children:"P and Q length(digits): "}),Object(R.jsx)("input",{type:"number",value:G,min:5,max:500,onChange:function(e){return K(parseInt(e.target.value))}})]}),Object(R.jsx)("div",{className:"text padding-y",children:Object(R.jsxs)("button",{onClick:function(){return Y(!J)},children:["Show ",J?"hex":"decimal"," values"]})}),Object(R.jsx)("p",{children:Object(R.jsx)("b",{children:"Your private exponent:"})}),Object(R.jsx)("textarea",{ref:e,className:"key-view",readOnly:!0})]}),Object(R.jsxs)("div",{className:"text-center text",children:[Object(R.jsx)("p",{children:Object(R.jsx)("b",{children:"Your public exponent:"})}),Object(R.jsx)("textarea",{ref:t,className:"key-view",readOnly:!0})]}),Object(R.jsxs)("div",{className:"text-center text",children:[Object(R.jsx)("p",{children:Object(R.jsx)("b",{children:"Modulus:"})}),Object(R.jsx)("textarea",{ref:r,className:"key-view",readOnly:!0})]}),Object(R.jsx)("hr",{}),Object(R.jsxs)("div",{className:"wraper",children:[Object(R.jsx)("div",{className:"side",children:Object(R.jsxs)("div",{className:"inner-wrapper",children:[Object(R.jsx)("h3",{children:"Encrypt:"}),Object(R.jsxs)("div",{className:"form-group",children:[Object(R.jsx)("label",{htmlFor:"message",children:"Message:"}),Object(R.jsx)("textarea",{name:"message",ref:c,rows:6})]}),Object(R.jsxs)("div",{className:"form-group",children:[Object(R.jsx)("label",{children:"Friends modulus(hex):"}),Object(R.jsx)("input",{type:"text",ref:a,placeholder:"modulus"}),Object(R.jsx)("label",{children:"Friends public exponent(hex):"}),Object(R.jsx)("input",{type:"text",ref:s,placeholder:"public exponent"})]}),Object(R.jsxs)("div",{className:"center",children:[Object(R.jsxs)("div",{className:"text padding-y",children:[Object(R.jsx)("label",{htmlFor:"add-padding-checkbox",children:"Add padding: "}),Object(R.jsx)("input",{type:"checkbox",name:"add-padding-checkbox",checked:C,onChange:function(){return M(!C)}})]}),Object(R.jsxs)("button",{onClick:te,children:[p&&Object(R.jsx)(d.ClipLoader,{size:10})," encrypt"]})]}),Object(R.jsxs)("div",{className:"form-group",children:[Object(R.jsx)("label",{htmlFor:"encrypted-message",children:"Encrypted message(hex):"}),Object(R.jsx)("textarea",{name:"encrypted-message",ref:i,rows:6,readOnly:!0})]})]})}),Object(R.jsx)("div",{className:"side",children:Object(R.jsxs)("div",{className:"inner-wrapper",children:[Object(R.jsx)("h3",{children:"Decrypt:"}),Object(R.jsxs)("div",{className:"form-group",children:[Object(R.jsx)("label",{htmlFor:"message",children:"Encrypted message(hex):"}),Object(R.jsx)("textarea",{name:"message",ref:b,rows:6})]}),Object(R.jsxs)("div",{className:"center",children:[Object(R.jsxs)("div",{className:"text padding-y",children:[Object(R.jsx)("label",{htmlFor:"remove-padding-checkbox",children:"Remove padding:"}),Object(R.jsx)("input",{type:"checkbox",name:"remove-padding-checkbox",checked:A,onChange:function(){return H(!A)}})]}),Object(R.jsxs)("button",{onClick:function(){if(E(!0),!b.current||!O.current)return alert("Something went wrong, please try again later."),void E(!1);var e=b.current.value;if(e&&0!==e.length){var t=m(e).modPow(ee.current,X.current);setTimeout((function(){var e=function(e){var t=f(g(e));console.log("hexValue",t);for(var r="",n=0;n<t.length;n+=2)r+=String.fromCharCode(parseInt(t[n]+t[n+1],16));return r}(t.toString()),r=D.current?function(e){var t=e.split(" ");return t.shift(),t.pop(),t.join(" ")}(e):e;O.current.innerHTML=r,E(!1)}),1e3)}},className:"btn",children:[k&&Object(R.jsx)(d.ClipLoader,{size:10}),"decrypt"]})]}),Object(R.jsxs)("div",{className:"form-group",children:[Object(R.jsx)("label",{htmlFor:"encrypted-message",children:"Decrypted message:"}),Object(R.jsx)("textarea",{name:"encrypted-message",ref:O,rows:6,readOnly:!0})]})]})})]})]})]})};r(49);s.a.render(Object(R.jsx)(c.a.StrictMode,{children:Object(R.jsx)(w,{})}),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.ea2378f7.chunk.js.map